{{ define "main" }}
<main class="min-h-screen">
  <div class="max-w-7xl mx-auto px-4 py-8 md:py-12">
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
      <!-- サイドプロフィール -->
      <aside class="lg:col-span-1">
        <div class="bg-white dark:bg-black border border-gray-200 dark:border-white rounded-xl p-6 shadow-md sticky top-20">
          {{ with .Params.author_image }}
          <img src="{{ . }}" alt="{{ $.Params.author }}" class="w-24 h-24 rounded-full mx-auto mb-4 object-cover border-4 border-gray-200 dark:border-white">
          {{ end }}
          <h3 class="text-xl font-bold text-gray-900 dark:text-white text-center mb-2">
            {{ .Params.author }}
          </h3>
          <p class="text-gray-600 dark:text-white text-sm text-center mb-4">
            {{ .Params.author_desc }}
          </p>
          <button class="w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors shadow-md hover:shadow-lg">
            ＋フォロー
          </button>
        </div>
      </aside>

      <!-- 本文エリア -->
      <article class="lg:col-span-3">
        <!-- 前の記事・次の記事（上部） -->
        <nav class="flex justify-between items-center mb-6 pb-4 border-b border-gray-200 dark:border-white">
          {{ with .PrevInSection }}
            <a class="text-sm text-blue-600 dark:text-blue-400 hover:underline" href="{{ .RelPermalink }}">
              ← {{ .Title }}
            </a>
          {{ else }}
            <span></span>
          {{ end }}
          {{ with .NextInSection }}
            <a class="text-sm text-blue-600 dark:text-blue-400 hover:underline" href="{{ .RelPermalink }}">
              {{ .Title }} →
            </a>
          {{ else }}
            <span></span>
          {{ end }}
        </nav>

        <!-- 動画 or 画像 -->
        {{ if .Params.featured_video }}
        <div class="mb-8 rounded-xl overflow-hidden shadow-lg">
          <iframe src="{{ .Params.featured_video }}" frameborder="0" allowfullscreen class="w-full aspect-video"></iframe>
        </div>
        {{ else if .Params.featured_image }}
        <div class="mb-8 rounded-xl overflow-hidden shadow-lg">
          <img src="{{ .Params.featured_image }}" alt="{{ .Title }}" class="w-full h-auto object-cover">
        </div>
        {{ end }}

        <!-- タイトル・本文 -->
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4">
          {{ .Title }}
        </h1>
        <div class="text-gray-500 dark:text-white text-sm mb-8">
          <span>{{ .Date.Format "2006年1月2日 15:04" }}</span>
          {{ with .Params.category }}
            <span> / {{ . }}</span>
          {{ end }}
        </div>

        <div class="prose prose-lg dark:prose-invert max-w-none text-gray-800 dark:text-gray-200 leading-relaxed">
          {{ .Content }}
        </div>

        <!-- タグ -->
        {{ with .Params.tags }}
        <div class="flex flex-wrap gap-2 mt-8 pt-8 border-t border-gray-200 dark:border-white">
          {{ range . }}
          <a href="/tags/{{ . | urlize }}" class="px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded-full text-sm hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors">
            #{{ . }}
          </a>
          {{ end }}
        </div>
        {{ end }}

        <!-- 前の記事・次の記事（下部） -->
        <nav class="flex justify-between items-center mt-12 pt-6 border-t border-gray-200 dark:border-white">
          {{ with .PrevInSection }}
            <a class="text-blue-600 dark:text-blue-400 hover:underline" href="{{ .RelPermalink }}">
              ← {{ .Title }}
            </a>
          {{ else }}
            <span></span>
          {{ end }}
          {{ with .NextInSection }}
            <a class="text-blue-600 dark:text-blue-400 hover:underline" href="{{ .RelPermalink }}">
              {{ .Title }} →
            </a>
          {{ else }}
            <span></span>
          {{ end }}
        </nav>
      </article>
    </div>
  </div>
</main>
{{ end }}
